{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>{{ product.name }} - Kingfood</title>
<link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">

<!-- Styles -->
<link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<link rel="stylesheet" href="{% static 'css/responsive.css' %}">
<link rel="stylesheet" href="{% static 'css/custom.css' %}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4/animate.min.css">

<style>/* ===== Food Details ===== */
.food-details {
  padding: 90px 0 60px;
}

.food-image {
  position: relative;
}

.food-image img {
  border-radius: 20px;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  display: block;
  width: 100%;
}

.small-gallery img {
  cursor: pointer;
  border-radius: 8px;
  width: 60px;
  transition: transform 0.2s, border 0.2s;
}

.small-gallery img:hover {
  transform: scale(1.2);
  border: 2px solid #28a745;
}

/* ===== ZOOM BOX ===== */
#zoomBox {
  position: fixed;
  right: 40px;
  top: 140px;
  width: 420px;
  height: 420px;
  border: 2px solid #28a745;
  background-repeat: no-repeat;
  background-size: 200%;
  display: none;
  z-index: 9999;
  border-radius: 12px;
  opacity: 0;
  transform: scale(0.8);
  transition: opacity 0.25s ease, transform 0.25s ease;
}

/* ===== Product Info ===== */
.food-info h1 {
  font-size: 36px;
  font-weight: 700;
  margin: 20px 0 15px;
}

.food-info h4 {
  color: #28a745;
  font-weight: 600;
  font-size: 22px;
  margin-bottom: 20px;
}

.food-info p.lead {
  font-size: 17px;
  color: #555;
  line-height: 1.8;
}

.food-info .rating {
  font-size: 20px;
  color: #ffc107;
}

/* ===== Add to Cart ===== */
.add-to-cart {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-top: 25px;
  min-height: 60px;
}

.add-to-cart button {
  border-radius: 30px;
  padding: 10px 25px;
  font-size: 16px;
  font-weight: 600;
  transition: all 0.2s ease;
}

.add-to-cart button:hover {
  transform: scale(1.05);
}

/* ===== Quantity Control ===== */
.quantity-control {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  min-height: 50px;
}

.quantity-control button:hover {
  transform: scale(1.1);
}

.quantity {
  min-width: 35px;
  text-align: center;
  font-size: 18px;
  font-weight: 600;
}

/* ===== Reviews Section ===== */
.reviews-section {
  padding: 60px 0 80px;
  background-color: #fafafa;
}

.reviews-header {
  text-align: center;
  margin-bottom: 50px;
}

.reviews-header h3 {
  font-weight: 700;
  font-size: 28px;
  margin-bottom: 15px;
}

.review-summary {
  font-size: 18px;
  color: #555;
}

.review-summary strong {
  color: #28a745;
  font-size: 22px;
}

.review-item {
  background: #fff;
  border-radius: 15px;
  padding: 25px;
  margin-bottom: 20px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: transform 0.2s ease;
}

.review-item:hover {
  transform: translateY(-3px);
}

.review-rating {
  font-size: 20px;
  color: #ffc107;
  margin-bottom: 8px;
}

.review-user h5 {
  margin-bottom: 3px;
  font-weight: 600;
}

.review-user small {
  color: #999;
}

/* ===== Star Rating ===== */
.star-rating {
  display: flex;
  flex-direction: row-reverse;
  justify-content: flex-end;
  gap: 5px;
}

.star-rating input {
  display: none;
}

.star-rating label {
  font-size: 26px;
  color: #ccc;
  cursor: pointer;
  transition: color 0.2s;
}

.star-rating input:checked ~ label,
.star-rating label:hover,
.star-rating label:hover ~ label {
  color: #ffc107;
}

/* ===== Review Gallery ===== */
.review-gallery {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 10px;
}

.review-gallery img.review-thumb {
  width: 65px;
  height: 65px;
  object-fit: cover;
  border-radius: 8px;
  cursor: pointer;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
}

.review-gallery img.review-thumb:hover {
  transform: scale(1.25);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
}

/* ===== Review Image Modal ===== */
#reviewImageModal {
  display: none;
  position: fixed;
  z-index: 99999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(3px);
  justify-content: center;
  align-items: center;
  flex-direction: column;
}

#reviewImageModal img {
  max-width: 80%;
  max-height: 70vh;
  border-radius: 12px;
  margin-bottom: 20px;
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
  animation: fadeZoom 0.3s ease forwards;
}

@keyframes fadeZoom {
  from {
    opacity: 0;
    transform: scale(0.8);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

#reviewImageModal .info-box {
  color: #fff;
  text-align: center;
  max-width: 80%;
}

#reviewImageModal .info-box h5 {
  margin-bottom: 8px;
  font-size: 20px;
}

#reviewImageModal .info-box p {
  font-size: 16px;
  color: #ddd;
  line-height: 1.6;
}

#reviewImageModal .close-btn {
  position: absolute;
  top: 25px;
  right: 35px;
  color: white;
  font-size: 40px;
  cursor: pointer;
  transition: color 0.2s;
}

#reviewImageModal .close-btn:hover {
  color: #ff5555;
}

/* ===== Stars Average ===== */
.stars-avg {
  color: #ffc107;
  font-size: 1.2rem;
}

.stars-avg .empty {
  color: #ddd;
}

/* ===== Cart Popup ===== */
#cartPopup {
  display: none;
  position: fixed;
  right: 30px;
  bottom: 30px;
  width: 360px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-radius: 15px;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  z-index: 10000;
  padding: 20px;
  opacity: 0;
  transform: translateY(50px);
  transition: all 0.35s ease;
}

#cartPopup.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}

#cartPopup h4 {
  font-size: 20px;
  margin-bottom: 15px;
  color: #28a745;
}

#cartPopup ul {
  list-style: none;
  padding: 0;
  max-height: 200px;
  overflow-y: auto;
}

#cartPopup ul li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 0;
  border-bottom: 1px solid #eee;
}

#cartPopup .cart-total {
  font-weight: 700;
  margin-top: 10px;
  display: flex;
  justify-content: space-between;
}

#cartPopup button.close-cart {
  background: #28a745;
  color: #fff;
  border: none;
  padding: 10px 18px;
  border-radius: 8px;
  cursor: pointer;
  margin-top: 15px;
  width: 100%;
  font-weight: 600;
  transition: all 0.25s ease;
}

#cartPopup button.close-cart:hover {
  background: #218838;
}
/* Ø¹Ù„Ø§Ù…Øª Ø¯Ø±ØµØ¯ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø¨Ø§Ù„Ø§ Ø³Ù…Øª Ø±Ø§Ø³Øª */
.discount-symbol-3d {
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 40px;
    font-weight: 900;
    color: white;
    text-shadow:
        1px 1px 0 #a00000,
        2px 2px 0 #760000,
        4px 4px 5px rgba(0, 0, 0, 0.45);
    transform: rotateX(15deg) rotateY(-15deg);
    animation: percentJump 1.4s infinite ease-in-out;
}

@keyframes percentJump {
    0%   { transform: translateY(0) rotateX(15deg) rotateY(-15deg); }
    50%  { transform: translateY(-8px) rotateX(10deg) rotateY(-10deg); }
    100% { transform: translateY(0) rotateX(15deg) rotateY(-15deg); }
}

/* Ø¯Ø±ØµØ¯ ØªØ®ÙÛŒÙ Ú©Ù†Ø§Ø± Ù‚ÛŒÙ…Øª (Ù‡Ù…ÛŒØ´Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯) */
.discount-amount.show {
    margin-left: 8px;
    font-weight: bold;
    color: #b30000;
    background: #ffe6e6;
    padding: 3px 8px;
    border-radius: 6px;
    border: 1px solid #ff4d4d;
    font-size: 14px;
    box-shadow: 0 1px 4px rgba(255, 0, 0, 0.25);
    opacity: 1; /* Ù‡Ù…ÛŒØ´Ù‡ Ø¯ÛŒØ¯Ù‡ Ø´ÙˆØ¯ */
    transform: translateX(0); /* Ø¨Ø¯ÙˆÙ† Ø§Ù†ÛŒÙ…ÛŒØ´Ù† hover */
}

/* ===== Ù‚Ø§Ø¨ ØªØµÙˆÛŒØ± Ø¨Ø§ Ù†ÙˆØ§Ø± Ø±Ù†Ú¯ÛŒ Ø¯Ø± Ø­Ø§Ù„Øª ØªØ®ÙÛŒÙ ===== */
.twisted-border {
    position: relative;
    display: inline-block;
    border-radius: 12px;
    padding: 0;
    overflow: visible;
    pointer-events: none;
}

.twisted-border::before {
    content: "";
    position: absolute;
    inset: -4px; /* Ø¶Ø®Ø§Ù…Øª Ù†ÙˆØ§Ø± */
    border-radius: 14px;
    background: repeating-linear-gradient(
        45deg,
        #ff3b3b 0 6px,
        #ff9900 6px 12px
    );
    -webkit-mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
    mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
    -webkit-mask-composite: destination-out;
    mask-composite: exclude;
    padding: 4px;
}

.twisted-border img {
    display: block;
    border-radius: 12px;
    pointer-events: auto; /* âœ… ÙÙ‚Ø· Ø®ÙˆØ¯ ØªØµÙˆÛŒØ± Ù…ÙˆØ³ Ø±Ùˆ Ø¨Ú¯ÛŒØ±Ù‡ */
}


/* ===== Ø¹Ù„Ø§Ù…Øª Ø¯Ø±ØµØ¯ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø¨Ø§Ù„Ø§ Ø±ÙˆÛŒ ØªØµÙˆÛŒØ± ===== */
.discount-symbol-3d {
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 40px;
    font-weight: 900;
    color: #ffffff;
    text-shadow:
        1px 1px 0 #a00000,
        2px 2px 0 #760000,
        4px 4px 5px rgba(0, 0, 0, 0.45);
    transform: rotateX(15deg) rotateY(-15deg);
    animation: percentJump 1.4s infinite ease-in-out;
    pointer-events: none; /* âœ… Ù…ÙˆØ³ Ø§Ø² Ø§ÛŒÙ† Ø¹Ø¨ÙˆØ± Ù…ÛŒâ€ŒÚ©Ù†Ù‡ */
}


/* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¨Ø§Ù„Ø§â€“Ù¾Ø§ÛŒÛŒÙ† Ø¯Ø±ØµØ¯ */
@keyframes percentJump {
    0%   { transform: translateY(0) rotateX(15deg) rotateY(-15deg); }
    50%  { transform: translateY(-8px) rotateX(10deg) rotateY(-10deg); }
    100% { transform: translateY(0) rotateX(15deg) rotateY(-15deg); }
}

/* ===== Ø¨Ø§Ú©Ø³ ØªØ®ÙÛŒÙ Ú©Ù†Ø§Ø± Ù‚ÛŒÙ…Øª ===== */
.discount-amount {
    margin-left: 8px;
    font-weight: bold;
    color: #b30000;
    opacity: 0;
    transform: translateX(-10px);
    transition: 0.25s;
    background: #ffe6e6;
    padding: 3px 8px;
    border-radius: 6px;
    border: 1px solid #ff4d4d;
    font-size: 14px;
    box-shadow: 0 1px 4px rgba(255, 0, 0, 0.25);
}

/* ÙØ¹Ø§Ù„ Ø´Ø¯Ù† Ø¨Ø§Ú©Ø³ ØªØ®ÙÛŒÙ Ù‡Ù†Ú¯Ø§Ù… hover Ú©Ø§Ø±Øª */
.food-info:hover .discount-amount {
    opacity: 1;
    transform: translateX(0);
}

/* ===== Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ ===== */
@media (max-width: 576px) {
    .discount-symbol-3d {
        font-size: 26px;
        top: 5px;
        right: 6px;
    }
    .discount-amount {
        font-size: 12px;
        padding: 2px 6px;
    }
}
/* === ğŸ›’ Modern Cart Dropdown with Smooth Transition & Backdrop === */
.cart-count {
  position: absolute;
  top: 0;
  right: -5px;
  background: #dc3545;
  color: #fff;
  font-size: 13px;
  border-radius: 50%;
  padding: 2px 7px;
  font-weight: 600;
  display: inline-block;
  box-shadow: 0 0 5px rgba(220, 53, 69, 0.5);
}

#cart-menu { position: relative; display:inline-block; }
.cart-count {
  position: absolute; top: -6px; right: -10px;
  background:#e60023;color:#fff;font-size:11px;padding:2px 6px;border-radius:12px;font-weight:700;
}

/* popup */
.cart-popup {
  position: absolute;
  top: 120%;
  right: 0;
  width: 360px;
  background: rgba(255,255,255,0.95);
  border-radius: 14px;
  padding: 14px;
  box-shadow: 0 12px 36px rgba(0,0,0,0.16);
  display: none;
  z-index: 1200;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}
#cart-menu:hover .cart-popup { display:block; }

/* tag */
.cart-tag {
  display:inline-block;padding:6px 12px;border-radius:999px;background:rgba(0,0,0,0.06);font-weight:600;margin-bottom:10px;
}

/* items */
.cart-items { max-height:320px; overflow-y:auto; padding-right:6px; margin-bottom:10px; }
.cart-item { display:flex; gap:12px; align-items:flex-start; padding:8px 4px; border-radius:10px; }
.cart-img { width:64px;height:64px;object-fit:cover;border-radius:8px; flex-shrink:0; }
.item-info { flex:1; min-width:0; }

/* name */
.item-info .name { margin:0 0 6px 0; font-weight:600; font-size:0.95rem; color:#111; }

/* price + discount */
.price-final { margin:0; font-weight:700; color:#1aa34a; font-size:1rem; }
.discount-label { margin:4px 0 0 0; font-size:0.85rem; color:#d40000; opacity:0.95; }

/* qty */
.quantity-control { display:flex; align-items:center; gap:8px; margin-top:8px; }
.quantity-control button {
  width:30px;height:30px;border-radius:8px;border:1px solid #e0e0e0;background:#fafafa; cursor:pointer;
  font-size:18px; font-weight:700; line-height:1;
}
.quantity { min-width:26px; text-align:center; font-weight:700; }

/* footer */
.cart-total-row { display:flex; justify-content:space-between; font-weight:700; padding-top:8px; border-top:1px solid #eee; margin-top:8px; }
.btn-continue { width:100%; margin-top:8px; padding:10px 0; border-radius:10px; border:none; background:linear-gradient(135deg,#007bff,#0056d6); color:#fff; font-weight:700; cursor:pointer; }
.btn-continue:hover { transform:translateY(-2px); box-shadow:0 8px 18px rgba(0,86,214,0.18); }

/* scrollbar */
.cart-items::-webkit-scrollbar{ width:6px; }
.cart-items::-webkit-scrollbar-thumb{ background:rgba(0,0,0,0.12); border-radius:8px; }

.item-info {
  flex: 1;
}

.name {
  font-weight: 500;
  margin: 0;
  font-size: 0.95rem;
}

.price {
  font-weight: 600;
  margin: 2px 0;
}

.original-price {
  font-size: 0.8rem;
}

.quantity-control {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-top: 5px;
}

.quantity-control button {
  width: 25px;
  height: 25px;
  border: 1px solid #ccc;
  border-radius: 6px;
  background: #f5f5f5;
  cursor: pointer;
  font-weight: bold;
  line-height: 1;
}

.quantity {
  min-width: 20px;
  text-align: center;
}



/* NAME */
.info .name {
    font-weight: 600;
    font-size: 14px;
    margin: 0 0 4px 0;
}

/* PRICE â€” NO DISCOUNT */
.price-normal {
    font-size: 14px;
    font-weight: 700;
    color: #28a745;
    margin: 0;
}

/* PRICE â€” DISCOUNTED (RED STRIKED) */
.price-discount {
    color: #d40000;
    font-size: 13px;
    font-weight: 600;
    margin: 0;
    text-decoration: line-through;
    opacity: 0.8;
}

/* PRICE â€” FINAL (GREEN) */
.price-final {
    color: #1aa34a;
    font-size: 15px;
    font-weight: 700;
    margin: 2px 0 0 0;
}

/* TOTAL */
.cart-total-row {
    display: flex;
    justify-content: space-between;
    font-size: 15px;
    font-weight: 700;
    padding: 8px 0;
    border-top: 1px solid #ececec;
    margin-bottom: 12px;
}

/* CONTINUE BUTTON */
.btn-continue {
    width: 100%;
    padding: 11px;
    background: #007bff;
    color: #fff;
    border: none;
    border-radius: 10px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.2s;
}

.btn-continue:hover {
    background: #0056b3;
}

/* === Item Info === */
.item-info {
  flex: 1;
}

.item-info .name {
  margin: 0;
  font-weight: 600;
  font-size: 15px;
  color: #333;
}

.item-info .price {
  margin: 3px 0 0;
  color: #28a745;
  font-size: 14px;
}

/* === Quantity Control === */
.quantity-control {
  display: flex;
  align-items: center;
  gap: 6px;
}

.quantity-control button {
  border: none;
  background: #e9ecef;
  color: #333;
  border-radius: 6px;
  padding: 3px 8px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.quantity-control button:hover {
  background: #007bff;
  color: #fff;
  transform: translateY(-1px);
}
/* Ù…ÙˆÙ‚Ø¹ÛŒØª ØµØ­ÛŒØ­ Ú©Ù†Ø§Ø± Ø¢ÛŒÚ©Ù† */
/* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ */
#cart-menu {
    position: relative;
    display: inline-block;
}

/* Ù¾Ø§Ù¾â€ŒØ¢Ù¾ Ú©Ø§Ø±Øª */
#cart-menu .cart-popup {
    position: absolute;
    top: 130%;
    right: 0;
    width: 340px;
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
    border-radius: 18px;
    padding: 16px;
    box-shadow: 0 12px 40px rgba(0,0,0,0.18);
    border: 1px solid rgba(255,255,255,0.4);
    
    display: none;
    z-index: 999;

    /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† */
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.25s ease-out;
}

/* Ù†Ù…Ø§ÛŒØ´ Ø¨Ø§ Hover */
#cart-menu:hover .cart-popup {
    display: block;
    opacity: 1;
    transform: translateY(0);
}

/* Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ */
.cart-items {
    max-height: 260px;
    overflow-y: auto;
    padding-right: 6px;
    margin-bottom: 14px;
}

/* Ø§Ø³Ú©Ø±ÙˆÙ„ Ø´ÛŒÚ© */
.cart-items::-webkit-scrollbar {
    width: 6px;
}
.cart-items::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.3);
    border-radius: 10px;
}
.cart-items::-webkit-scrollbar-thumb {
    background: rgba(0,0,0,0.2);
    border-radius: 10px;
}

/* Ù‡Ø± Ø¢ÛŒØªÙ… */
.cart-items .item {
    display: flex;
    justify-content: space-between;
    padding: 10px 6px;
    margin-bottom: 8px;
    background: rgba(255,255,255,0.55);
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

/* ÙÙˆØªØ± */
.cart-popup-footer a {
    display: block;
    text-align: center;
    padding: 12px;
    background: linear-gradient(135deg, #007bff, #0056d6);
    color: white !important;
    border-radius: 14px;
    text-decoration: none;
    font-weight: 600;
    font-size: 15px;
    transition: 0.25s;
}

.cart-popup-footer a:hover {
    background: linear-gradient(135deg, #0056d6, #003c9f);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.18);
}


/* ===== Ù†ÙˆØ§Ø± Ø¯ÙˆØ± ØªØµÙˆÛŒØ± ÙˆÙ‚ØªÛŒ ØªØ®ÙÛŒÙ Ø¯Ø§Ø±Ø¯ ===== */
.discount-border {
    position: relative;
    display: inline-block;
    border-radius: 12px;
    padding: 0; /* Ù†ÙˆØ§Ø± Ú©Ø§Ù…Ù„Ø§Ù‹ Ú†Ø³Ø¨ÛŒØ¯Ù‡ Ø¨Ù‡ ØªØµÙˆÛŒØ± */

    border: 3px solid transparent;
    background: linear-gradient(#ffffff, #ffffff) padding-box,
                linear-gradient(45deg, #ff4d4d, #ff9900, #ff4d4d) border-box;
}

.discount-border img {
    border-radius: 12px;
}


/* ===== Ø¹Ù„Ø§Ù…Øª Ø¯Ø±ØµØ¯ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø¨Ø§Ù„Ø§ ===== */
.discount-symbol-3d {
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 45px;
    font-weight: 900;
    color: #ffffff;

    text-shadow: 
        1px 1px 0 #990000,
        2px 2px 0 #770000,
        3px 3px 0 #550000,
        4px 4px 5px rgba(0,0,0,0.45);

    transform: rotateX(15deg) rotateY(-15deg);
    animation: percentJump 1.4s infinite ease-in-out;
}

/* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¨Ø§Ù„Ø§â€“Ù¾Ø§ÛŒÛŒÙ† Ø¯Ø±ØµØ¯ */
@keyframes percentJump {
    0%   { transform: translateY(0) rotateX(15deg) rotateY(-15deg); }
    50%  { transform: translateY(-8px) rotateX(10deg) rotateY(-10deg); }
    100% { transform: translateY(0) rotateX(15deg) rotateY(-15deg); }
}


/* ===== Ø¨Ø§Ú©Ø³ ØªØ®ÙÛŒÙ Ú©Ù‡ Ø¨Ø§ hover Ø¸Ø§Ù‡Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ ===== */
.discount-amount {
    margin-left: 8px;
    font-weight: bold;
    color: #ffffff;

    opacity: 0;
    transform: translateX(-10px);
    transition: 0.25s;

    background: #ff0000;
    padding: 3px 8px;
    border-radius: 6px;
    border: 1px solid #ff0000;
    font-size: 14px;
    box-shadow: 0 1px 4px rgba(255, 0, 0, 0.25);
}

/* ÙØ¹Ø§Ù„ Ø´Ø¯Ù† Ø¨Ø§Ú©Ø³ ØªØ®ÙÛŒÙ Ù‡Ù†Ú¯Ø§Ù… hover Ú©Ø§Ø±Øª */
.product-card:hover .discount-amount {
    opacity: 1;
    transform: translateX(0);
}


/* ===== Ø¸Ø§Ù‡Ø± Ú©Ù„ÛŒ Ú©Ø§Ø±Øª ===== */
.product-card {
    position: relative;
    overflow: hidden;
    border-radius: 12px;
}

.product-card img {
    border-radius: 12px;
    width: 100%;
}



/* ===== Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ) ===== */
@media (max-width: 576px) {
    .discount-symbol-3d {
        font-size: 26px;
        top: 5px;
        right: 6px;
    }
    .discount-amount {
        font-size: 12px;
        padding: 2px 6px;
    }
}



.discount-border img {
    border-radius: 12px;
}
/* ===== Ù†ÙˆØ§Ø± Ù…Ø§Ø±Ù¾ÛŒÚ†ÛŒ Ø¯ÙˆØ± ØªØµÙˆÛŒØ± ÙÙ‚Ø· Ø¯Ø± Ø­Ø§Ù„Øª ØªØ®ÙÛŒÙ ===== */
.twisted-border {
    position: relative;
    display: inline-block;
    border-radius: 12px;
    padding: 0;
    overflow: visible;
}

/* Ø³Ø§Ø®Øª Ù†ÙˆØ§Ø± Ø·Ù†Ø§Ø¨ÛŒ Ø¨Ø§ pseudo-element */
.twisted-border::before {
    content: "";
    position: absolute;
    inset: -4px; /* Ø¶Ø®Ø§Ù…Øª Ù†ÙˆØ§Ø± */
    border-radius: 14px;

    background: repeating-linear-gradient(
        45deg,
        #ff3b3b 0 6px,
        #ff9900 6px 12px
    );

    -webkit-mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
    mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);

    -webkit-mask-composite: destination-out;
    mask-composite: exclude;

    padding: 4px;
}

/* ØªØµÙˆÛŒØ± Ø¯Ø§Ø®Ù„ Ù†ÙˆØ§Ø± */
.twisted-border img {
    display: block;
    border-radius: 12px;
}


/* ===== Ø¯Ø±ØµØ¯ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø¨Ø§Ù„Ø§ ===== */
.discount-symbol-3d {
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 40px;
    font-weight: 900;
    color: white;

    text-shadow:
        1px 1px 0 #a00000,
        2px 2px 0 #760000,
        4px 4px 5px rgba(0, 0, 0, 0.45);

    transform: rotateX(15deg) rotateY(-15deg);
    animation: percentJump 1.4s infinite ease-in-out;
}

/* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¨Ø§Ù„Ø§ Ù¾Ø§ÛŒÛŒÙ† Ø¯Ø±ØµØ¯ */
@keyframes percentJump {
    0%   { transform: translateY(0) rotateX(15deg) rotateY(-15deg); }
    50%  { transform: translateY(-8px) rotateX(10deg) rotateY(-10deg); }
    100% { transform: translateY(0) rotateX(15deg) rotateY(-15deg); }
}


/* ===== Ø¨Ø§Ú©Ø³ ØªØ®ÙÛŒÙ Hover ===== */
.discount-amount {
    margin-left: 8px;
    font-weight: bold;
    color: #b30000;

    opacity: 0;
    transform: translateX(-10px);
    transition: 0.25s;

    background: #ffe6e6;
    padding: 3px 8px;
    border-radius: 6px;
    border: 1px solid #ff4d4d;
    font-size: 14px;
    box-shadow: 0 1px 4px rgba(255, 0, 0, 0.25);
}

.product-card:hover .discount-amount {
    opacity: 1;
    transform: translateX(0);
}

</style>

</head>

<body>

{% include 'freshbread/header.html' %}

<section class="food-details">
<div class="container">
<div class="row align-items-center">

<div class="col-lg-6 col-md-12 food-image mb-4 mb-lg-0">
    <div class="{% if product.discount_percent %}twisted-border{% endif %}">
        <img id="mainProductImage" src="{{ product.menu_image.url }}" alt="{{ product.name }}" class="img-fluid rounded">

        {% if product.discount_percent %}
        <div class="discount-symbol-3d">%</div>
        {% endif %}
    </div>

    <div id="zoomBox"></div>

    {% if product.gallery_images.all %}
    <div class="d-flex flex-wrap gap-2 mt-2">
        {% for img in product.gallery_images.all %}
            <img src="{{ img.image.url }}" class="img-thumbnail small-gallery" onclick="document.getElementById('mainProductImage').src='{{ img.image.url }}'">
        {% endfor %}
    </div>
    {% endif %}
</div>


<!-- Product Info -->
<div class="col-lg-6 col-md-12 food-info">
<h1>{{ product.name }}</h1>
<p class="review-summary"> 
  <span class="stars-avg">
    {% for _ in "12345" %}
      {% if forloop.counter <= avg_rating %}
        â˜…
      {% else %}
        <span class="empty">â˜…</span>
      {% endif %}
    {% endfor %}
  </span>
  <strong>({{ avg_rating }})</strong> â€” Based on {{ approved_reviews_count }} reviews
</p>
<h4>
  {% if product.discount_percent %}
    <span class="text-muted"><del>${{ product.original_price }}</del></span>
    <span class="text-success fw-bold ms-2">${{ product.price }}</span>
    <!-- Ø¯Ø±ØµØ¯ ØªØ®ÙÛŒÙ Ù‡Ù…ÛŒØ´Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯ -->
    <span class="discount-amount show">{{ product.discount_percent }}%</span>
  {% else %}
    <span class="text-success">${{ product.price }}</span>
  {% endif %}
</h4>


<p class="lead">{{ product.description }}</p>


<!-- Add to Cart -->
<div class="add-to-cart" data-product-slug="{{ product.slug }}">
  <!-- Ú©Ù†ØªØ±Ù„ ØªØ¹Ø¯Ø§Ø¯ -->
  <div class="quantity-control {% if cart_quantity == 0 %}d-none{% endif %}">
    <button class="btn btn-outline-danger btn-sm decrease" title="Decrease">âˆ’</button>
    <span class="quantity fs-5 fw-bold">
      {% if cart_quantity == 0 %}Item deleted{% else %}{{ cart_quantity }}{% endif %}
    </span>
    <button class="btn btn-outline-success btn-sm increase" title="Increase">+</button>
  </div>

  <!-- Ø¯Ú©Ù…Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ -->
  <button class="btn btn-success btn-add px-4 py-2 fw-semibold rounded-pill {% if cart_quantity > 0 %}d-none{% endif %}">
    ğŸ›’ Add to Cart
  </button>

  <!-- Ø¯Ú©Ù…Ù‡ View Cart Ø¨Ø§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† -->
  <a href="{% url 'reservation' %}" class="btn btn-primary btn-view-cart d-none ms-2">
    View Cart
  </a>

  <!-- Ø§Ø¯Ø§Ù…Ù‡ Ø®Ø±ÛŒØ¯ -->
  <a href="{% url 'menu' %}" class="btn btn-outline-success">
    Continue Shopping
  </a>
</div>


<div class="continue-shopping">

</div>

</div>
</div>
</div>
</section>

<!-- Reviews Section -->
<section class="reviews-section">
<div class="container">
<div class="reviews-header">
<h3>Customer Reviews</h3>
<p class="review-summary">
  Average Rating: 
  <span class="stars-avg">
    {% for _ in "12345" %}
      {% if forloop.counter <= avg_rating %}
        â˜…
      {% else %}
        <span class="empty">â˜…</span>
      {% endif %}
    {% endfor %}
  </span>
  <strong>({{ avg_rating }})</strong> â€” Based on {{ approved_reviews_count }} reviews
</p>

</div>

<div class="row">
<div class="col-lg-8 col-md-10 mx-auto">

{% if approved_reviews %}
  {% for review in approved_reviews %}
    <div class="review-item">
      <div class="review-user d-flex align-items-center gap-3 mb-2">
          <img src="{{ review.user.profile.avatar.url }}" alt="{{ review.first_name }}" class="rounded-circle" width="55" height="55" onerror="this.onerror=null;this.src='{% static 'images/profile-7.jpg' %}'">
        <div>
          <h5 class="mb-0"><a href="{% url 'public_user_profile' review.user.id %}">{{ review.first_name }} {{ review.last_name }}</a></h5>
          <small class="text-muted">{{ review.created_at|timesince }} ago</small>
        </div>
      </div>

      <!-- Ø³ØªØ§Ø±Ù‡â€ŒÙ‡Ø§ -->
      <div class="review-rating mb-2">
        {% for i in "12345" %}
          {% if forloop.counter <= review.rating %}â­{% else %}â˜†{% endif %}
        {% endfor %}
      </div>

      <!-- Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ø¢Ù¾Ù„ÙˆØ¯Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø± -->
{% if review.images.all %}
<div class="user-gallery">
  {% for img in review.images.all %}
    <img src="{{ img.image.url }}" alt="Review image"
         class="user-photo"
         data-user="{{ review.first_name }} {{ review.last_name }}"
         data-rating="{{ review.rating }}"
         data-review="{{ review.comment|escapejs }}">
  {% endfor %}
</div>
{% endif %}

      <p class="mb-0">{{ review.comment }}</p>
    </div>
  {% endfor %}
{% else %}
  <p class="text-center text-muted">No reviews yet. Be the first!</p>
{% endif %}

{% if user.is_authenticated %}
<div class="add-review mt-5">
<h5 class="mb-3">Leave a Review</h5>
<form method="post" action="{% url 'add_review' product.slug %}" enctype="multipart/form-data">
{% csrf_token %}
<div class="form-group">
<label>Rate this product:</label>
<div class="star-rating">
{% for i in "54321" %}
<input type="radio" id="{{ i }}-stars" name="rating" value="{{ i }}" required>
<label for="{{ i }}-stars">â˜…</label>
{% endfor %}
</div>
</div>

<div class="form-group mt-3">
<label for="reviewText">Your Review</label>
<textarea id="reviewText" rows="4" class="form-control" name="comment" placeholder="Write your feedback..." required></textarea>
</div>

<div class="form-group mt-3">
  <label for="reviewImages">Upload Images (optional)</label>
  <input type="file" name="images" multiple>
</div>

</div>

<button type="submit" class="btn btn-warning text-white mt-3">Submit Review</button>
</form>
</div>
{% else %}
<p class="text-center mt-3">
You must <a href="{% url 'ru' %}?next={{ request.path }}">log in</a> to post a review.
</p>
{% endif %}

</div>
</div>
</div>
</section>

<!-- Scripts -->
<script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
<script src="{% static 'js/popper.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>

<div id="reviewImageModal">
  <span class="close-btn">&times;</span>
  <img id="modalReviewImg" src="" alt="">
  <div class="info-box">
    <h5 id="modalReviewerName"></h5>
    <p id="modalReviewerComment"></p>
    <div id="modalReviewerStars" style="font-size:22px; color:#ffc107;"></div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* -----------------------
     0) IMAGE HOVER POPUP
  ----------------------- */
  const productImage = document.querySelector(".food-image img");
  if (productImage) {
    const popup = document.createElement("div");
    popup.className = "image-popup";
    popup.innerHTML = `<p>${productImage.alt || "Product Image"}</p>`;
    document.body.appendChild(popup);

    productImage.addEventListener("mouseenter", (e) => {
      popup.style.opacity = "1";
      popup.style.transform = "translate(-50%, -120%) scale(1)";
      popup.style.left = e.pageX + "px";
      popup.style.top = e.pageY - 30 + "px";
      productImage.classList.add("zoom-in");
    });

    productImage.addEventListener("mousemove", (e) => {
      popup.style.left = e.pageX + "px";
      popup.style.top = e.pageY - 30 + "px";
    });

    productImage.addEventListener("mouseleave", () => {
      popup.style.opacity = "0";
      popup.style.transform = "translate(-50%, -100%) scale(0.8)";
      productImage.classList.remove("zoom-in");
    });
  }

  /* -----------------------
     1) CSS ANIMATION FOR POPUP & ZOOM
  ----------------------- */
  const style = document.createElement("style");
  style.innerHTML = `
    @keyframes fadeInOut {
      0% { opacity: 0; transform: translateY(-20px); }
      10% { opacity: 1; transform: translateY(0); }
      90% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-20px); }
    }
    .image-popup {
      position: absolute;
      background: rgba(0,0,0,0.8);
      color: #fff;
      padding: 8px 14px;
      border-radius: 8px;
      font-size: 14px;
      opacity: 0;
      transform: translate(-50%, -100%) scale(0.8);
      pointer-events: none;
      transition: all 0.3s ease;
      z-index: 9999;
    }
    .food-image img { transition: transform 0.3s ease; }
    .food-image img.zoom-in { transform: scale(1.1); filter: brightness(1.1); }
  `;
  document.head.appendChild(style);

  /* -----------------------
     2) CART + VIEW CART BUTTON
  ----------------------- */
  const cartBox = document.querySelector(".add-to-cart");
  const viewCartBtn = document.querySelector('.btn-view-cart');

  function updateViewCartBtn() {
    if (!viewCartBtn) return;
    const cartRows = document.querySelectorAll('#cart-section tbody tr');
    if (cartRows.length > 0) {
      viewCartBtn.classList.remove('d-none');
      let totalItems = 0;
      cartRows.forEach(row => {
        const qty = parseInt(row.querySelector('span[id^="qty-"]').innerText || '0', 10);
        totalItems += qty;
      });
      viewCartBtn.textContent = `View Cart (${totalItems})`;
    } else {
      viewCartBtn.classList.add('d-none');
    }
  }

  if (cartBox) {
    const slug = cartBox.dataset.productSlug;
    const maxQty = 5;
    const addBtn = cartBox.querySelector(".btn-add");
    const qtyBox = cartBox.querySelector(".quantity-control");
    const qtyText = qtyBox ? qtyBox.querySelector(".quantity") : null;
    const increaseBtn = qtyBox ? qtyBox.querySelector(".increase") : null;
    const decreaseBtn = qtyBox ? qtyBox.querySelector(".decrease") : null;

    const priceBox = document.createElement("div");
    priceBox.className = "price-box text-end mt-2 fw-bold text-success fs-5";
    cartBox.appendChild(priceBox);

    let qty = qtyText ? parseInt(qtyText.textContent.replace(/\D/g, '')) || 0 : 0;
    const unitPriceEl = document.querySelector(".food-info h4");
    const unitPrice = unitPriceEl ? parseFloat(unitPriceEl.textContent.replace(/[^0-9.\-]/g, '')) || 0 : 0;

    function updatePrice() {
      priceBox.innerHTML = qty > 0 ? `Total: $${(qty * unitPrice).toFixed(2)}` : '';
    }

    function showToast(msg, type = "success") {
      const toast = document.createElement("div");
      toast.textContent = msg;
      toast.style.cssText = `
        position:fixed; right:20px; top:20px; z-index:99999;
        background:${type === "error" ? "#dc3545" : "#28a745"};
        color:#fff; padding:12px 20px; border-radius:10px; font-weight:600;
        box-shadow:0 4px 12px rgba(0,0,0,0.2);
        animation:fadeInOut 2s ease forwards;
      `;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 2000);
    }

    function updateUI() {
      if (!qtyBox || !addBtn) return;
      if (qty <= 0) {
        qtyBox.classList.add("d-none");
        addBtn.classList.remove("d-none");
        priceBox.innerHTML = "";
      } else {
        qtyBox.classList.remove("d-none");
        addBtn.classList.add("d-none");
        qtyText.textContent = qty;
      }

      if (increaseBtn) {
        if (qty >= maxQty) {
          increaseBtn.disabled = true;
          increaseBtn.style.opacity = "0.5";
          increaseBtn.style.cursor = "not-allowed";
        } else {
          increaseBtn.disabled = false;
          increaseBtn.style.opacity = "1";
          increaseBtn.style.cursor = "pointer";
        }
      }

      updatePrice();
      updateViewCartBtn();
    }

    async function updateServer(newQty) {
      try {
        const resp = await fetch(`/cart/set_cart_quantity/${slug}/${newQty}/`, {
          method: "GET",
          headers: { "X-Requested-With": "XMLHttpRequest" },
          credentials: "same-origin"
        });
        const data = await resp.json();
        if (data.success) showToast(`Cart updated (${data.quantity})`);
        else showToast(data.message || "Failed to update cart", "error");
      } catch (err) {
        console.error(err);
        showToast("Network error", "error");
      }
    }

    if (addBtn) addBtn.addEventListener("click", async () => { qty = 1; updateUI(); await updateServer(qty); });
    if (increaseBtn) increaseBtn.addEventListener("click", async () => { if (qty < maxQty) { qty++; updateUI(); await updateServer(qty); } else showToast(`Max ${maxQty}`, "error"); });
    if (decreaseBtn) decreaseBtn.addEventListener("click", async () => { qty--; if (qty <= 0) { qty = 0; updateUI(); await updateServer(0); } else { updateUI(); await updateServer(qty); } });
    updateUI();
  }

  /* -----------------------
     3) FIXED ZOOM BOX (DIGI-KALA STYLE)
  ----------------------- */
  (function setupFixedZoom() {
    const mainImg = document.getElementById("mainProductImage");
    if (!mainImg) return;

    let zoomBox = document.getElementById("zoomBox");
    if (!zoomBox) {
      zoomBox = document.createElement("div");
      zoomBox.id = "zoomBox";
      document.body.appendChild(zoomBox);
    }

    let zoomedImg = zoomBox.querySelector("img");
    if (!zoomedImg) {
      zoomedImg = document.createElement("img");
      zoomedImg.id = "zoomedImage";
      zoomBox.appendChild(zoomedImg);
    }

    Object.assign(zoomBox.style, {
      position: "fixed", right: "40px", top: "140px",
      width: "420px", height: "420px", overflow: "hidden",
      border: "2px solid #28a745", borderRadius: "12px",
      background: "#fff", boxShadow: "0 6px 20px rgba(0,0,0,0.25)",
      display: "none", opacity: "0", transform: "scale(0.9)",
      transition: "opacity .28s ease, transform .28s ease", zIndex: "99999"
    });

    Object.assign(zoomedImg.style, {
      width: "200%", height: "200%", objectFit: "cover",
      transform: "scale(1)", transformOrigin: "50% 50%",
      transition: "transform .08s linear, transform-origin .08s linear",
      display: "block"
    });

    mainImg.addEventListener("mouseenter", () => {
      zoomedImg.src = mainImg.currentSrc || mainImg.src;
      zoomBox.style.display = "block";
      requestAnimationFrame(() => { zoomBox.style.opacity = "1"; zoomBox.style.transform = "scale(1)"; });
    });

    mainImg.addEventListener("mousemove", (e) => {
      const rect = mainImg.getBoundingClientRect();
      const clampedX = Math.max(0, Math.min(e.clientX - rect.left, rect.width));
      const clampedY = Math.max(0, Math.min(e.clientY - rect.top, rect.height));
      const xPercent = (clampedX / rect.width) * 100;
      const yPercent = (clampedY / rect.height) * 100;
      zoomedImg.style.transformOrigin = `${xPercent}% ${yPercent}%`;
      zoomedImg.style.transform = "scale(2)";
    });

    mainImg.addEventListener("mouseleave", () => {
      zoomBox.style.opacity = "0";
      zoomBox.style.transform = "scale(0.9)";
      zoomedImg.style.transform = "scale(1)";
      setTimeout(() => { zoomBox.style.display = "none"; }, 300);
    });
  })();

});
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* -----------------------
     4) USER GALLERY MODAL
  ----------------------- */
  const photos = document.querySelectorAll(".user-gallery .user-photo");
  if (photos.length === 0) return;

  const modal = document.createElement("div");
  modal.className = "photo-modal";
  modal.innerHTML = `
    <div class="photo-overlay"></div>
    <div class="photo-content">
      <button class="nav-btn prev">&#10094;</button>
      <img class="modal-img" src="" alt="">
      <button class="nav-btn next">&#10095;</button>
      <div class="photo-info"></div>
    </div>
  `;
  document.body.appendChild(modal);

  const overlay = modal.querySelector(".photo-overlay");
  const modalImg = modal.querySelector(".modal-img");
  const photoInfo = modal.querySelector(".photo-info");
  const prevBtn = modal.querySelector(".prev");
  const nextBtn = modal.querySelector(".next");

  let currentIndex = 0;

  function getStars(rating) {
    rating = parseFloat(rating);
    if (isNaN(rating)) rating = 0;
    const full = Math.floor(rating);
    const half = rating % 1 >= 0.5 ? 1 : 0;
    const empty = 5 - full - half;
    let stars = "â˜…".repeat(full);
    if (half) stars += "â­";
    stars += "â˜†".repeat(empty);
    return stars;
  }

  function openModal(index) {
    currentIndex = index;
    const photo = photos[index];
    const rating = photo.dataset.rating || 0;
    const user = photo.dataset.user || "Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ø´Ù†Ø§Ø³";
    const review = photo.dataset.review || "Ø¨Ø¯ÙˆÙ† Ù†Ø¸Ø±";

    modalImg.src = photo.src;
    photoInfo.innerHTML = `
      <h5 class="fw-bold text-success mt-3">${user}</h5>
      <div class="stars" style="color:gold; font-size:1.3rem;">${getStars(rating)}</div>
      <div style="color:#666; font-size:0.9rem;">Rating: ${parseFloat(rating).toFixed(1)} / 5</div>
      <p class="user-review mt-3" style="font-size:1rem; color:#444; line-height:1.6;">â€œ${review}â€</p>
    `;

    modal.style.display = "flex";
    requestAnimationFrame(() => modal.classList.add("show"));
  }

  function closeModal() {
    modal.classList.remove("show");
    setTimeout(() => (modal.style.display = "none"), 300);
  }

  function showPhoto(dir) {
    currentIndex = (currentIndex + dir + photos.length) % photos.length;
    openModal(currentIndex);
  }

  photos.forEach((photo, index) => photo.addEventListener("click", () => openModal(index)));
  overlay.addEventListener("click", closeModal);
  prevBtn.addEventListener("click", () => showPhoto(-1));
  nextBtn.addEventListener("click", () => showPhoto(1));

  const style = document.createElement("style");
  style.innerHTML = `
    .user-gallery { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px; }
    .user-photo { width: 100px; height: 100px; object-fit: cover; border-radius: 10px; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; }
    .user-photo:hover { transform: scale(1.08); box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    .photo-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; transition: opacity 0.3s ease; z-index: 10000; }
    .photo-modal.show { opacity: 1; }
    .photo-overlay { position: absolute; inset: 0; cursor: pointer; }
    .photo-content { position: relative; z-index: 2; background: #fff; padding: 20px; border-radius: 15px; box-shadow: 0 6px 20px rgba(0,0,0,0.3); text-align: center; animation: popIn .3s ease; }
    .modal-img { max-width: 80vw; max-height: 70vh; border-radius: 10px; }
    .photo-info { margin-top: 10px; font-size: 1.1rem; }
    .user-review { margin-top: 10px; font-style: italic; }
    .nav-btn { position: absolute; top: 50%; transform: translateY(-50%); background: #28a745; color: #fff; border: none; border-radius: 50%; width: 45px; height: 45px; font-size: 1.5rem; cursor: pointer; transition: background 0.3s; }
    .nav-btn:hover { background: #218838; }
    .prev { left: -60px; }
    .next { right: -60px; }
    @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
  `;
  document.head.appendChild(style);

});

/* -----------------------
   5) CART POPUP QUANTITY UPDATE
----------------------- */
document.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('.cart-popup').forEach(popup => {
    popup.addEventListener('click', function (e) {
      if (e.target.classList.contains('increase') || e.target.classList.contains('decrease')) {
        const item = e.target.closest('.cart-item');
        const slug = item.dataset.slug;
        const quantityElem = item.querySelector('.quantity');
        let quantity = parseInt(quantityElem.textContent) || 1;

        if (e.target.classList.contains('increase')) quantity++;
        if (e.target.classList.contains('decrease')) quantity--;

        quantity = Math.max(0, Math.min(quantity, 5));

        fetch(`/cart/set_cart_quantity/${slug}/${quantity}/`, {
          method: 'POST',
          headers: {
            'X-CSRFToken': '{{ csrf_token }}',
            'X-Requested-With': 'XMLHttpRequest'
          }
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            if (quantity === 0) item.remove();
            else quantityElem.textContent = data.quantity;

            const countElem = document.querySelector('#cart-count');
            let total = 0;
            document.querySelectorAll('.cart-item .quantity').forEach(q => { total += parseInt(q.textContent) || 0; });
            countElem.textContent = total > 0 ? total : '';

            Swal.fire({ toast: true, position: 'top-end', icon: 'success', title: data.message, showConfirmButton: false, timer: 1500 });
          }
        })
        .catch(err => console.error('Error:', err));
      }
    });
  });
});

function updateViewCartBtn() {
  const viewCartBtn = document.querySelector('.btn-view-cart');
  const cartRows = document.querySelectorAll('#cart-section tbody tr');

  if (cartRows.length > 0) {
    viewCartBtn.classList.remove('d-none');
    viewCartBtn.animate([
      { transform: 'translateY(-10px)', opacity: 0.5 },
      { transform: 'translateY(0)', opacity: 1 }
    ], { duration: 300, easing: 'ease-out' });
  } else {
    viewCartBtn.animate([
      { transform: 'translateY(0)', opacity: 1 },
      { transform: 'translateY(10px)', opacity: 0 }
    ], { duration: 300, easing: 'ease-in' }).onfinish = () => {
      viewCartBtn.classList.add('d-none');
    };
  }
}
</script>



</body>
</html>
