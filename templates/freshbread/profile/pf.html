{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">   
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>{{ user.first_name }} - Kingfood</title>  

	<!-- Favicon -->
	<link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">

	<!-- Bootstrap & Styles -->
	<link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/style.css' %}">
	<link rel="stylesheet" href="{% static 'css/responsive.css' %}">
	<link rel="stylesheet" href="{% static 'css/custom.css' %}">

	<style>
		.profile-header {
			text-align: center;
			background: #fff;
			padding: 40px 20px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
			border-radius: 15px;
			margin: 50px auto 30px;
			width: 85%;
		}
		.profile-header img {
			width: 120px; height: 120px;
			border-radius: 50%; border: 3px solid #ffc107; object-fit: cover;
		}
		.profile-header h3 { margin-top: 15px; font-weight: 700; color: #333; }
		.profile-header p { color: #777; }
		.profile-header button {
			background: #ffc107; border: none; color: #fff;
			border-radius: 25px; padding: 8px 20px; margin-top: 10px;
			transition: 0.3s;
		}
		.profile-header button:hover { background: #e0a800; }

		.order-section {
			background: #fff; border-radius: 15px; padding: 30px;
			margin: 20px auto; width: 85%; box-shadow: 0 2px 8px rgba(0,0,0,0.05);
		}
		.order-category {
			text-align: center;
			font-weight: 700; font-size: 22px;
			margin-bottom: 20px; color: #444;
			display: flex; align-items: center; justify-content: center; gap: 10px;
		}
		.order-card {
			background: #fafafa; border-radius: 12px;
			padding: 20px; margin-bottom: 15px;
			display: flex; align-items: center; justify-content: space-between;
			box-shadow: 0 2px 6px rgba(0,0,0,0.05);
			transition: 0.3s; cursor: pointer;
		}
		.order-card:hover { transform: translateY(-3px); background: #fff; }
		.order-info { flex: 1; }
		.order-info h6 { font-weight: 600; margin-bottom: 5px; }
		.order-info small { color: #777; }
		.order-status img { width: 45px; height: 45px; }

		.empty-text { color: #999; text-align: center; margin: 20px 0; }
	</style>




{% include 'freshbread/header.html' %}
<h2></h2><br>
<h2></h2><br>

	<!-- Profile Header -->
	<div class="profile-header">
		<img id="avatarPreview" src="{{ profile.avatar.url }}" alt="User Profile" style="border-radius:50%; width:130px; height:130px; object-fit:cover; border:4px solid #28a745; box-shadow:0 4px 10px rgba(0,0,0,0.2)" onerror="this.onerror=null;this.src='{% static 'images/def.jpg' %}'">
		<h3>{{ user.first_name }} {{ user.last_name }}</h3>
		<p>{{ user.email }}</p>
		<div>
			<button onclick="window.location.href='{% url 'edit_profile' %}'">Edit Profile ‚úèÔ∏è</button>
			<button onclick="window.location.href='{% url 'locations_manage' %}'" style="margin-left:10px;background:#17a2b8">Manage Locations üìç</button>
			<button onclick="window.location.href='{% url 'logout' %}'" style="margin-left:10px;background:#ff0000">logout <i class="fa-solid fa-right-from-bracket"></i>
</button>
		</div>
		<div class="alert alert-info mt-3" role="alert" style="border-radius:12px; display:inline-block; text-align:left;">
			<div><strong>Your referral code:</strong> <code>{{ profile.referral_code }}</code></div>
			<div class="mt-1"><strong>Orders from your referrals:</strong> {{ profile.referral_used_count }}</div>
		</div>
	</div>

	<!-- Orders Section -->
	<div class="container">
<!-- Active Orders -->
<div class="order-section">
    <div class="order-category">
        <img src="https://img.icons8.com/fluency/48/000000/play.png" alt="Active">
        Active Orders
    </div>

    {% if active_orders %}
        {% for order in active_orders %}
            <div class="order-card" onclick="window.location.href='{% url 'order_detail' order.order_code %}'">
                <div class="order-info">
                    <h6>Order #{{ order.order_code }}</h6>
                    <small>
                        Total: ${{ order.total_price }}
                        {% if order.delivery_slot %} | Delivery time: {{ order.delivery_slot }}{% endif %}
                        {% if order.delivery_code %} | Delivery code: {{ order.delivery_code }}{% endif %}
                    </small>
                </div>
                <div class="order-status">
                    {% if order.status == 'pending' %}
                        <img src="https://img.icons8.com/fluency/48/000000/hourglass.png" alt="Pending" width="32">
                    {% elif order.status == 'processing' %}
                        <img src="https://img.icons8.com/color/48/000000/rotate-right.png" alt="Processing" width="32">
                    {% elif order.status == 'cooking' %}
                        <img src="https://img.icons8.com/color/48/000000/cooking.png" alt="Cooking" width="32">
                    {% elif order.status == 'queued' %}
                        <img src="https://img.icons8.com/color/48/000000/package.png" alt="Queued" width="32">
                    {% elif order.status == 'sending' %}
                        <img src="https://img.icons8.com/color/48/000000/truck.png" alt="Sending" width="32">
                    {% elif order.status == 'ready' %}
                        <img src="https://img.icons8.com/fluency/48/000000/hand.png" alt="Ready for Pickup" width="32">
                        <img src="https://img.icons8.com/fluency/48/000000/ok.png" alt="Ready for Pickup" width="32">
                    {% else %}
                        <img src="https://img.icons8.com/fluency/48/000000/question.png" alt="Active" width="32">
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p class="empty-text">No active Order yet! <a href="{% url 'reservation' %}">Order something now!</a></p>
    {% endif %}
</div>


<!-- Delivered Orders -->
<div class="order-section">
    <div class="order-category">
        <img src="https://img.icons8.com/fluency/48/000000/ok" alt="Delivered">
        Delivered Orders
    </div>

    {% if delivered_orders %}
        {% for order in delivered_orders %}
            <div class="order-card" onclick="window.location.href='{% url 'order_detail' order.order_code %}'">
                <div class="order-info">
                    <h6>Order #{{ order.order_code }}</h6>
                    <small>
                        Total: ${{ order.total_price }}
                        {% if order.delivery_slot %} | Delivery time: {{ order.delivery_slot }}{% endif %}
                        {% if order.delivery_code %} | Delivery code: {{ order.delivery_code }}{% endif %}
                    </small>
                </div>
                <div class="order-status">
                    <img src="https://img.icons8.com/fluency/48/000000/checked-checkbox.png" alt="Delivered">
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p class="empty-text">No delivered Order yet!</p>
    {% endif %}
</div>


<!-- Cancelled Orders -->
<div class="order-section">
    <div class="order-category">
        <img src="https://img.icons8.com/fluency/48/000000/cancel.png" alt="Cancelled">
        Cancelled Orders
    </div>

    {% if cancelled_orders %}
        {% for order in cancelled_orders %}
            <div class="order-card" onclick="window.location.href='{% url 'order_detail' order.order_code %}'">
                <div class="order-info">
                    <h6>Order #{{ order.order_code }}</h6>
                    <small>
                        Total: ${{ order.total_price }}
                        {% if order.delivery_slot %} | Delivery time: {{ order.delivery_slot }}{% endif %}
                        {% if order.delivery_code %} | Delivery code: {{ order.delivery_code }}{% endif %}
                    </small>
                </div>
                <div class="order-status">
                    <img src="https://img.icons8.com/fluency/48/000000/cancel.png" alt="Cancelled">
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p class="empty-text">No cancelled Order yet!</p>
    {% endif %}
</div>
</div>


    {% include 'freshbread/footer.html' %}

	<!-- ALL JS FILES -->
	<script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
	<script src="{% static 'js/popper.min.js' %}"></script>
	<script src="{% static 'js/bootstrap.min.js' %}"></script>
    <!-- ALL PLUGINS -->
	<script src="{% static 'js/jquery.superslides.min.js' %}"></script>
	<script src="{% static 'js/images-loded.min.js' %}"></script>
	<script src="{% static 'js/isotope.min.js' %}"></script>
	<script src="{% static 'js/baguetteBox.min.js' %}"></script>
	<script src="{% static 'js/form-validator.min.js' %}"></script>
    <script src="{% static 'js/contact-form-script.js' %}"></script>
    <script src="{% static 'js/custom.js' %}"></script>
</body>
</html>
